<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>HVE Quiz | High Voltage Engineering</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">

</head>

<body>

<header>
  <h1>‚ö° HVE Quiz</h1>
  <p>High Voltage Engineering ‚Äì Practice Exam</p>
</header>

<div class="container">
  <div id="quiz">
    <div id="question" class="question"></div>
    <div id="questionImage" class="question-image"></div>
    <div id="nav" class="nav"></div>
    <div id="choices" class="choices"></div>

    <div class="buttons">
      <button class="btn-secondary" onclick="prevQuestion()">‚¨Ö ‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
      <button class="btn-primary" onclick="nextQuestion()">‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°</button>
    </div>

    <div id="result" class="result"></div>
  </div>
</div>

<footer>
  ¬© 2026 High Voltage Engineering Quiz
</footer>

<script src="quiz.js"></script>
<script src="app.js"></script>

<script>
  let currentIndex = 0;
  let userAnswers = [];       // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (index)
  let locked = [];            // ‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏´‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠

  function getCorrectIndex(q) {
    return (typeof q.answer === "number") ? q.answer : q.answerIndex;
  }

  // =========================
  // Navigator (1‚Äì100)
  // =========================
  function buildNav() {
    const nav = document.getElementById("nav");
    if (!nav) return;

    nav.innerHTML = "";

    quizData.forEach((q, i) => {
      const btn = document.createElement("button");
      btn.className = "nav-btn";
      btn.type = "button";
      btn.textContent = q.id;

      btn.addEventListener("click", () => {
        currentIndex = i;
        loadQuestion();
      });

      nav.appendChild(btn);
    });

    updateNav();
  }

  function updateNav() {
    const buttons = document.querySelectorAll("#nav .nav-btn");

    buttons.forEach((btn, i) => {
      btn.classList.remove("current", "answered", "unanswered");

      if (i === currentIndex) {
        btn.classList.add("current");
        return;
      }

      if (typeof userAnswers[i] === "number") {
        btn.classList.add("answered");
      } else {
        btn.classList.add("unanswered");
      }
    });
  }

  // =========================
  // Load Question
  // =========================
  function loadQuestion() {
    const q = quizData[currentIndex];

    document.getElementById("question").innerText =
      `‡∏Ç‡πâ‡∏≠ ${q.id}. ${q.question}`;

    // ===== ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ =====
    const imgBox = document.getElementById("questionImage");
    if (q.image) {
      imgBox.innerHTML = `<img src="${q.image}" class="q-img" alt="question image">`;
      imgBox.style.display = "block";
    } else {
      imgBox.innerHTML = "";
      imgBox.style.display = "none";
    }

    const choicesDiv = document.getElementById("choices");
    choicesDiv.innerHTML = "";

    // ‡∏•‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    document.getElementById("result").innerHTML = "";

    q.choices.forEach((choice, idx) => {
      const label = document.createElement("label");
      label.className = "choice";

      const checked = (userAnswers[currentIndex] === idx) ? "checked" : "";
      label.innerHTML = `
        <input type="radio" name="choice" value="${idx}" ${checked}>
        ${choice}
      `;

      // ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å
      if (locked[currentIndex]) {
        label.classList.add("disabled");
        label.querySelector("input").disabled = true;
      }

      // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÅ‡∏ö‡∏ö Forms
      label.addEventListener("click", () => {
        if (locked[currentIndex]) return; // ‡∏Å‡∏±‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ã‡πâ‡∏≥‡∏ï‡∏≠‡∏ô‡∏•‡πá‡∏≠‡∏Å

        const input = label.querySelector("input");
        input.checked = true;

        userAnswers[currentIndex] = idx;
        locked[currentIndex] = true;

        showInstantResult();
        disableChoices();
        updateNav(); // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏µ‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ö‡πÄ‡∏•‡∏Ç‡∏Ç‡πâ‡∏≠
      });

      choicesDiv.appendChild(label);
    });

    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏µ‡∏ñ‡∏π‡∏Å‡∏ú‡∏¥‡∏î‡∏ï‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡∏π
    if (locked[currentIndex] && typeof userAnswers[currentIndex] === "number") {
      showInstantResult();
      disableChoices();
    }

    updateNav(); // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï current/answered/unanswered ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠
  }

  function disableChoices() {
    document.querySelectorAll("#choices .choice").forEach(label => {
      label.classList.add("disabled");
      const input = label.querySelector("input");
      if (input) input.disabled = true;
    });
  }

  function showInstantResult() {
    const q = quizData[currentIndex];
    const correct = getCorrectIndex(q);
    const selected = userAnswers[currentIndex];

    // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    document.querySelectorAll("#choices .choice").forEach((label, idx) => {
      label.classList.remove("correct", "wrong");
      if (idx === correct) label.classList.add("correct");
      if (idx === selected && selected !== correct) label.classList.add("wrong");
    });

    const isCorrect = (selected === correct);
    const explainText = q.explain
      ? `<div style="margin-top:8px;opacity:.9">${q.explain}</div>`
      : "";

    document.getElementById("result").innerHTML = `
      <div class="feedback ${isCorrect ? "good" : "bad"}">
        <div class="badge">${isCorrect ? "‚úî ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á" : "‚úñ ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"}</div>
        <div>
          <div><b>‡πÄ‡∏â‡∏•‡∏¢:</b> ${q.choices[correct]}</div>
          ${explainText}
        </div>
      </div>

      <div class="small-actions">
        <button class="btn-outline" type="button" onclick="unlockCurrent()">‡πÅ‡∏Å‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ</button>
      </div>
    `;
  }

  function unlockCurrent() {
    locked[currentIndex] = false;
    loadQuestion();
    updateNav();
  }

  function nextQuestion() {
    if (currentIndex < quizData.length - 1) {
      currentIndex++;
      loadQuestion();
    } else {
      showScore();
    }
  }

  function prevQuestion() {
    if (currentIndex > 0) {
      currentIndex--;
      loadQuestion();
    }
  }

  function showScore() {
    let score = 0;
    quizData.forEach((q, i) => {
      const correct = getCorrectIndex(q);
      if (userAnswers[i] === correct) score++;
    });

    document.getElementById("quiz").innerHTML = `
      <h2>üéâ ‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</h2>
      <p>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <b>${score} / ${quizData.length}</b></p>
      <p style="color:#64748b">* ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
      <button class="btn-primary" type="button" onclick="location.reload()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
    `;
  }

  // =========================
  // Init
  // =========================
  if (!window.quizData || !quizData.length) {
    alert("‡πÑ‡∏°‡πà‡∏û‡∏ö quizData ‚Äî ‡πÄ‡∏ä‡πá‡∏Å‡πÑ‡∏ü‡∏•‡πå quiz.js ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ quizData");
  } else {
    buildNav();     // ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Å‡πà‡∏≠‡∏ô
    loadQuestion(); // ‚úÖ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠
  }
</script>



</body>
</html>
