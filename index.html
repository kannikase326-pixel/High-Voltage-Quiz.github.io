<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>HVE Quiz | High Voltage Engineering</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">

</head>

<body>

<header>
  <h1>‚ö° HVE Quiz</h1>
  <p>High Voltage Engineering ‚Äì Practice Exam</p>
</header>

<div class="container layout">
  <!-- ‡πÅ‡∏ñ‡∏ö‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡πâ‡∏≤‡∏á -->
  <aside class="sidebar">
    <div class="side-title">‡πÅ‡∏ñ‡∏ö‡∏Ç‡πâ‡∏≠</div>
    <div id="nav" class="nav-grid"></div>
  </aside>

  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö -->
  <main class="main">
    <div id="quiz" class="card">
      <div id="question" class="question"></div>
      <div id="questionImage" class="question-image"></div>
      <div id="choices" class="choices"></div>

      <div class="buttons sticky-actions">
        <button class="btn-secondary" onclick="prevQuestion()">‚¨Ö ‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
        <button class="btn-primary" onclick="nextQuestion()">‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°</button>
      </div>

      <div id="result" class="result"></div>
    </div>
  </main>
</div>


<footer>
  ¬© 2026 High Voltage Engineering Quiz
</footer>

<script src="quiz.js"></script>
<script src="app.js"></script>

<script>
  // =========================
  // State
  // =========================
  let currentIndex = 0;
  let userAnswers = []; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (index)
  let locked = [];      // ‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏´‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠

  function getCorrectIndex(q) {
    return (typeof q.answer === "number") ? q.answer : q.answerIndex;
  }

  // =========================
  // Navigator (1‚Äì100)
  // =========================
  function buildNav() {
    const nav = document.getElementById("nav");
    if (!nav) return;

    nav.innerHTML = "";

    quizData.forEach((q, i) => {
      const btn = document.createElement("button");
      btn.className = "nav-btn";
      btn.type = "button";
      btn.textContent = q.id;

      btn.addEventListener("click", () => {
        currentIndex = i;
        loadQuestion();
      });

      nav.appendChild(btn);
    });

    updateNav();
  }

  function updateNav() {
    const buttons = document.querySelectorAll("#nav .nav-btn");
    buttons.forEach((btn, i) => {
      btn.classList.remove("current", "answered", "unanswered");

      if (i === currentIndex) {
        btn.classList.add("current");
      } else if (typeof userAnswers[i] === "number") {
        btn.classList.add("answered");
      } else {
        btn.classList.add("unanswered");
      }
    });
  }

  // =========================
  // Load Question
  // =========================
  function loadQuestion() {
    const q = quizData[currentIndex];
    if (!q) return;

    const questionEl = document.getElementById("question");
    const imgBox = document.getElementById("questionImage");
    const choicesDiv = document.getElementById("choices");
    const resultEl = document.getElementById("result");

    if (questionEl) questionEl.innerText = `‡∏Ç‡πâ‡∏≠ ${q.id}. ${q.question}`;

    // ===== ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ =====
    if (imgBox) {
      if (q.image) {
        imgBox.innerHTML = `<img src="${q.image}" class="q-img" alt="question image">`;
        imgBox.style.display = "block";
      } else {
        imgBox.innerHTML = "";
        imgBox.style.display = "none";
      }
    }

    if (choicesDiv) choicesDiv.innerHTML = "";
    if (resultEl) resultEl.innerHTML = "";

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    q.choices.forEach((choice, idx) => {
      const label = document.createElement("label");
      label.className = "choice";

      const checked = (userAnswers[currentIndex] === idx) ? "checked" : "";

      label.innerHTML = `
        <input type="radio" name="choice" value="${idx}" ${checked}>
        <span>${choice}</span>
      `;

      const input = label.querySelector("input");

      // ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ disable
      if (locked[currentIndex] && input) {
        label.classList.add("disabled");
        input.disabled = true;
      }

      // ‡πÉ‡∏ä‡πâ change event ‡∏Ç‡∏≠‡∏á input ‡∏à‡∏∞‡∏ô‡∏¥‡πà‡∏á‡∏Å‡∏ß‡πà‡∏≤ click ‡∏ó‡∏µ‡πà label
      if (input) {
        input.addEventListener("change", () => {
          if (locked[currentIndex]) return;

          userAnswers[currentIndex] = idx;
          locked[currentIndex] = true;

          showInstantResult();
          disableChoices();
          updateNav();
        });
      }

      choicesDiv.appendChild(label);
    });

    // ‡∏ñ‡πâ‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß
    if (locked[currentIndex] && typeof userAnswers[currentIndex] === "number") {
      showInstantResult();
      disableChoices();
    }

    updateNav();
    scrollToTopSoft(); // ‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏î‡πâ‡∏á‡∏•‡∏á
  }

  function disableChoices() {
    document.querySelectorAll("#choices .choice").forEach(label => {
      label.classList.add("disabled");
      const input = label.querySelector("input");
      if (input) input.disabled = true;
    });
  }

  function showInstantResult() {
    const q = quizData[currentIndex];
    const correct = getCorrectIndex(q);
    const selected = userAnswers[currentIndex];

    // ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    document.querySelectorAll("#choices .choice").forEach((label, idx) => {
      label.classList.remove("correct", "wrong");
      if (idx === correct) label.classList.add("correct");
      if (idx === selected && selected !== correct) label.classList.add("wrong");
    });

    const isCorrect = (selected === correct);
    const explainText = q.explain
      ? `<div style="margin-top:8px;opacity:.9">${q.explain}</div>`
      : "";

    const resultEl = document.getElementById("result");
    if (!resultEl) return;

    resultEl.innerHTML = `
      <div class="feedback ${isCorrect ? "good" : "bad"}">
        <div class="badge">${isCorrect ? "‚úî ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á" : "‚úñ ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"}</div>
        <div>
          <div><b>‡πÄ‡∏â‡∏•‡∏¢:</b> ${q.choices[correct]}</div>
          ${explainText}
        </div>
      </div>

      <div class="small-actions">
        <button class="btn-outline" type="button" onclick="unlockCurrent()">‡πÅ‡∏Å‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ</button>
      </div>
    `;
  }

  function unlockCurrent() {
    locked[currentIndex] = false;
    loadQuestion();
    updateNav();
  }

  function nextQuestion() {
    if (currentIndex < quizData.length - 1) {
      currentIndex++;
      loadQuestion();
    } else {
      showScore();
    }
  }

  function prevQuestion() {
    if (currentIndex > 0) {
      currentIndex--;
      loadQuestion();
    }
  }

  function showScore() {
    let score = 0;
    quizData.forEach((q, i) => {
      const correct = getCorrectIndex(q);
      if (userAnswers[i] === correct) score++;
    });

    const quizEl = document.getElementById("quiz");
    if (!quizEl) return;

    quizEl.innerHTML = `
      <h2>üéâ ‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</h2>
      <p>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <b>${score} / ${quizData.length}</b></p>
      <p style="color:#64748b">* ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
      <button class="btn-primary" type="button" onclick="location.reload()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
    `;
  }

  function scrollToTopSoft() {
    // ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö (‡πÑ‡∏°‡πà‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏Å‡∏•‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤)
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  // =========================
  // Init
  // =========================
  if (!window.quizData || !quizData.length) {
    alert("‡πÑ‡∏°‡πà‡∏û‡∏ö quizData ‚Äî ‡πÄ‡∏ä‡πá‡∏Å‡πÑ‡∏ü‡∏•‡πå quiz.js ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ quizData");
  } else {
    buildNav();
    loadQuestion();
  }
</script>




</body>
</html>
